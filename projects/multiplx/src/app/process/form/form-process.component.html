<div class="subheader py-5 py-lg-10 gutter-b subheader-solid" id="kt_subheader"
    style="background-color: #127E9B; background-position: right bottom; background-size: auto 100%; background-repeat: no-repeat; background-image: url(assets/media/svg/patterns/art_barra.svg)">
    <div class="container-fluid d-flex flex-column">

        <!--begin::Title-->
        <div class="d-flex align-items-sm-end flex-column flex-sm-row mb-5">
            <h2 class="d-flex align-items-center text-white mr-5 mb-0">Adicionar Processo</h2>
        </div>

        <!--end::Title-->
    </div>
</div>

<!--end::Subheader-->

<!-- begin::Entry -->
<form class="form" novalidate #form="ngForm">
    <div class="card-body">
        <div class="form-group row">
            <div class="col-lg-4">
                <label>Cliente:</label>
                <ng-select [items]="clients$ | async" #selectClient="ngModel"
                    [ngClass]="{'is-invalid': process.client_id == null && error}" bindLabel="name" bindValue="id"
                    name="client_id" [multiple]="false" [hideSelected]="true" [loading]="clientLoading"
                    [typeahead]="clientinput$" notFoundText="Cliente não encontrado"
                    loadingText="Carregando..."
                    clearAllText="Limpar busca"
                    typeToSearchText="Digite para buscar cliente"
                    [(ngModel)]="process.client_id" required>
                </ng-select>
            </div>
            <div class="col-lg-4">
                <label>Data:</label>
                <input type="date" class="form-control" name="date" #date="ngModel" [(ngModel)]="process.date"
                    [ngClass]="{'is-invalid': !date.valid && error}" required />
            </div>
            <div class="col-lg-4">
                <label>Ano Previsto Pagamento:</label>
                <input type="date" class="form-control" name="payment_year" #payment_year="ngModel"
                    [(ngModel)]="process.payment_year" [ngClass]="{'is-invalid': !payment_year.valid && error}" required/>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-lg-4">
                <label>Valor Atualizado Bruto:</label>
                <div class="input-group">
                    <div class="input-group-prepend"><span class="input-group-text">R$</span></div>
                    <input type="text" class="form-control" required placeholder="99,90" mask="0*,09" name="value_rough" #value_rough="ngModel" [(ngModel)]="process.value_rough"  [ngClass]="{'is-invalid': !value_rough.valid && error}" />
                </div>
            </div>
            <div class="col-lg-4">
                <label>Valor Autor:</label>
                <div class="input-group">
                    <div class="input-group-prepend"><span class="input-group-text">R$</span></div>
                    <input type="text" class="form-control" required placeholder="99,90" mask="0*,09" name="value_author" #value_author="ngModel" [(ngModel)]="process.value_author" [ngClass]="{'is-invalid': !value_author.valid && error}" />
                </div>
            </div>
            <div class="col-lg-4">
                <label>Despesas Operacionais:</label>
                <div class="input-group">
                    <div class="input-group-prepend"><span class="input-group-text">R$</span></div>
                    <input type="text" class="form-control" required placeholder="99,90" mask="0*,09" name="outgoing_operationals" #outgoing_operationals="ngModel" [(ngModel)]="process.outgoing_operationals" [ngClass]="{'is-invalid': !outgoing_operationals.valid && error}" />
                </div>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-lg-4">
                <label>Despesas Judicais e Cartório:</label>
                <div class="input-group">
                    <div class="input-group-prepend"><span class="input-group-text">R$</span></div>
                    <input type="text" class="form-control" placeholder="99,90" mask="0*,09" name="outgoing_judicials"
                        #outgoing_judicials="ngModel" [(ngModel)]="process.outgoing_judicials" [ngClass]="{'is-invalid': !outgoing_judicials.valid && error}" required />
                </div>
            </div>
            <div class="col-lg-4">
                <label>Valor Total - Investidor:</label>
                <div class="input-group">
                    <div class="input-group-prepend"><span class="input-group-text">R$</span></div>
                    <input type="text" class="form-control" placeholder="99,90" mask="0*,09" name="total_value"
                        #total_value="ngModel" [(ngModel)]="process.total_value" [ngClass]="{'is-invalid': !total_value.valid && error}" required/>
                </div>
            </div>
            <div class="col-lg-4">
                <label>Valor Receber - Ano Previsto:</label>
                <input type="date" class="form-control" name="date_receive" #date_receive="ngModel"
                    [(ngModel)]="process.date_receive" [ngClass]="{'is-invalid': !date_receive.valid && error}" required/>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-lg-4">
                <label>Percentual de Ganho Ano Previsto:</label>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="99,90" mask="0*,09" name="percentual_gain"
                    #percentual_gain="ngModel" [(ngModel)]="process.percentual_gain" [ngClass]="{'is-invalid': !percentual_gain.valid && error}" required/>
                    <div class="input-group-prepend"><span class="input-group-text">%</span></div>
                </div>
            </div>
            <div class="col-lg-4">
                <label>Status:</label>
                <select (change)="onChangeStatusSelect($event.target.value)" class="form-control" required attr.data-placeholder="Selecione o status" [ngClass]="{'is-invalid': !process.status && error}">
                    <option [value]="">Selecione um status</option>
                    <option [value]="0">Iniciado</option>
                    <option [value]="1">Rejeitado</option>
                </select>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <button type="button" (click)="saveProcess()" class="btn btn-primary mr-2">Salvar</button>
        <a [routerLink]="['/processos']" class="btn btn-secondary">Cancelar</a>
    </div>
</form>
<!-- end::Entry -->
